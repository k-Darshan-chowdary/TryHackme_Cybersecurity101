INTRODUCTION:-
GUIs are easier for beginners, but CLIs become faster and more efficient once mastered. Command-line interfaces reduce reliance on the mouse, save time, and allow quick repetition of tasks. They also use fewer system resources, support easy automation through scripts, and enable efficient remote management via tools like SSH. The goal is to learn Windows Command Prompt (cmd.exe) to view system information, troubleshoot networks, manage files, and monitor running processes.


BASIC SYSTEM INFORMATION:-
Windows commands run from directories listed in the system PATH, which can be viewed using the set command. The ver command displays the Windows OS version, while systeminfo provides detailed system information such as OS details, hardware, processor, and memory. Long command outputs can be viewed page by page by piping them through more, and exited with CTRL + C. Useful basic commands include help for command guidance and cls to clear the screen.


NETWORK TROUBLESHOOTING:-
Windows CLI provides powerful networking tools for viewing and troubleshooting network activity.

-[ipconfig] shows basic network details like IP address, subnet mask, and gateway, while ipconfig /all displays extended information such as DNS servers and DHCP status.

-[ping] checks connectivity to a target and measures response time.

-[tracert] traces the route packets take to reach a destination, showing intermediate routers.

-[nslookup] resolves domain names to IP addresses using a chosen DNS server.

-[netstat] displays active connections and listening ports, and advanced options (-a -b -o -n) reveal all connections, associated programs, process IDs, and numeric addresses for deeper analysis.

FILE AND DISK MANAGEMENT:-
Directory commands

-[cd] → Shows current directory (no arguments) or moves to a target directory

-[cd ..] → Moves up one directory level

-[dir] → Lists files and subdirectories

----[dir /a] → Shows hidden/system files

----[dir /s] → Shows files in all subdirectories

-[tree] → Displays directory structure in a tree format

-[mkdir <name>] → Creates a directory

-[rmdir <name>] → Deletes a directory



File commands

-[type <file>] → Displays contents of a text file

-[more] → Views long text output page by page

-[copy <source> <destination>] → Copies files

-[move <source> <destination>] → Moves files

-[del / erase] → Deletes files




Wildcard

-[*] → Refers to multiple files (e.g., copy *.md C:\Markdown)



TASK AND PROCESS MANAGEMENT:-

-[tasklist] → Displays all running processes (similar to Task Manager)

-[tasklist /?] → Shows help and available filtering options

-[tasklist /FI "imagename eq <process>.exe"] → Filters processes by name

----Example: tasklist /FI "imagename eq sshd.exe"

-[taskkill /PID <pid>] → Terminates a process using its Process ID

These commands allow you to view, filter, and kill running processes directly from the command line.



Additional useful commands (not beginner-focused):

-[chkdsk] → Checks disk and file system for errors.

-[driverquery] → Lists installed device drivers.

-[sfc /scannow] → Scans and repairs corrupted system files.

-[/?] → Displays help page for most commands.

Using more:

-[more file.txt] → Display a text file page by page.

-[some_command | more] → Pipe long output to view it page by page.

Key takeaway: You can now view help pages for commands and handle long outputs efficiently.







[[POWERSHELL]]  :-

-PowerShell is a cross-platform automation and configuration tool from Microsoft that includes a command-line shell, scripting language, and management framework.

-It is object-oriented, built on the .NET framework, allowing it to work with structured data (objects) rather than plain text like traditional command-line tools.

-Originally created to address the limitations of cmd.exe and batch scripting in enterprise Windows environments.

-Jeffrey Snover designed PowerShell to align with Windows’ API-driven architecture instead of Unix-style text processing.

-First released in 2006 for Windows; expanded in 2016 with PowerShell Core, making it open-source and cross-platform (Windows, macOS, Linux).

-PowerShell cmdlets return objects with properties and methods, enabling more powerful, flexible, and efficient automation without complex text parsing.

-This object-based approach makes PowerShell especially effective for system administration and automation tasks.



Q} What do we call the advanced approach used to develop PowerShell?

* object-oriented


{Cmdlet Syntax}

-PowerShell commands are called cmdlets.

-They follow a clear Verb–Noun format:

---Verb = action (Get, Set, Add, Remove)

---Noun = target object (Content, Location, Date)

Examples:

-Get-Content → reads file content

-Set-Location → changes directory






{{Essential PowerShell Commands}}

[Get-Command]

-Lists all available cmdlets, functions, aliases, and scripts.

-Can filter results:

-Get-Command -CommandType Function

-Get-Help

-Shows documentation for any cmdlet.

Common usage:

-Get-Help Get-Date

-Get-Help Get-Date -examples

-Get-Help Get-Date -detailed

-Get-Help Get-Date -full

-Essential for learning syntax, parameters, and real usage.

[Get-Alias]

-Displays shortcut names for cmdlets.

Examples:

-dir → Get-ChildItem

-cd → Set-Location

-cat → Get-Content

-Helps users transition from traditional command-line tools.



{{Extending PowerShell with Modules}}

-[Find-Module]

-Searches online repositories (like PowerShell Gallery) for modules.

Supports wildcards:

-Find-Module -Name "PowerShell*"

-[Install-Module]

-Installs a module and makes new cmdlets available.

Example:

-Install-Module -Name PowerShellGet

-May prompt for trust confirmation when installing from online repositories.





Q} How would you retrieve a list of commands that start with the verb Remove? [for the sake of this question, avoid the use of quotes (" or ') in your answer]

Get-Command -Name Remove*



Q} What cmdlet has its traditional counterpart echo as an alias?

Write-Output


Q} What is the command to retrieve some example usage for the cmdlet New-LocalUser?

Get-Help New-LocalUser -examples




-PowerShell offers modern, unified cmdlets for navigating and managing files and directories, replacing multiple traditional Windows CLI commands with a consistent approach.

[File System Navigation]


[Get-ChildItem]

-Lists files and folders in a directory

Equivalent to:

-dir (Windows CLI)

-ls (Linux/macOS)

Usage:

-Get-ChildItem

-Get-ChildItem -Path "C:\Path"



[Set-Location]

-Changes the current working directory

-Equivalent to cd

Usage:

-Set-Location -Path ".\Documents"



[Creating Files and Directories]



[New-Item]

-Creates both files and directories using one cmdlet

-Requires:


-Path

-ItemType (File or Directory)

Examples:


Create a folder:

New-Item -Path ".\folder" -ItemType Directory


Create a file:

New-Item -Path ".\file.txt" -ItemType File





[Deleting Files and Directories]



[Remove-Item]

-Deletes files and directories

-Replaces del and rmdir

Usage:

Remove-Item -Path ".\file.txt"

Remove-Item -Path ".\folder"




[Copying and Moving Items]



[Copy-Item]

-Copies files or directories

-Equivalent to copy

Usage:

Copy-Item -Path source.txt -Destination copy.txt



[Move-Item]

-Moves or renames files and directories

-Equivalent to move

Usage:

Move-Item -Path old.txt -Destination new.txt






Q} What cmdlet can you use instead of the traditional Windows command type?

Get-Content

Q} What PowerShell command would you use to display the content of the "C:\Users" directory? [for the sake of this question, avoid the use of quotes (" or ') in your answer]

 Get-ChildItem -Path C:\Users

Q} How many items are displayed by the command described in the previous question?

4





-PowerShell piping (|) passes objects, not plain text, from one cmdlet to another. This allows powerful sorting, filtering, and searching using object properties.

Key Commands Used with Piping



[ | (Pipe) ]

-Sends output of one cmdlet as input to the next.

-Enables chaining multiple operations.


[Sort-Object]

-Sorts objects by a specified property.

Example:

Get-ChildItem | Sort-Object Length


[Where-Object]

-Filters objects based on conditions.

Common operators:

-eq → equal

-ne → not equal

-gt / -ge → greater than / greater or equal

-lt / -le → less than / less or equal

-like → pattern matching with wildcards

Examples:

Filter .txt files:

Get-ChildItem | Where-Object Extension -eq ".txt"

Filter by name pattern:

Get-ChildItem | Where-Object Name -like "ship*"



[Select-Object]

-Chooses specific properties or limits output.

Example:

Get-ChildItem | Select-Object Name, Length



[Select-String]

-Searches for text inside files.

-Similar to grep or findstr.

-Supports regex.

Example:

Select-String -Path file.txt -Pattern "hat"


Q} How would you retrieve the items in the current directory with size greater than 100? [for the sake of this question, avoid the use of quotes (" or ') in your answer]

Get-ChildItem | Where-Object -Property Length -gt 100



PowerShell System & Network Enumeration:-

PowerShell provides powerful cmdlets that return structured objects, making system administration, automation, and security analysis more efficient than traditional command-line tools.


Get-ComputerInfo
Retrieves detailed system information such as OS version, build, hardware, BIOS, and installation details. It provides a complete system snapshot and is more comprehensive than the legacy systeminfo command.

Get-LocalUser
Lists all local user accounts on the machine, showing usernames, account status (enabled/disabled), and descriptions. This cmdlet is essential for identifying active users and detecting suspicious or hidden accounts.

Get-NetIPConfiguration
Displays network interface configuration, including IP addresses, default gateways, and DNS servers. It serves as a modern alternative to ipconfig with more readable and structured output.

Get-NetIPAddress
Shows all IP addresses configured on the system, including IPv4, IPv6, loopback, and inactive addresses. Useful for detailed network analysis and troubleshooting.

These cmdlets allow administrators and security analysts to quickly gather system, user, and network information directly from the command line.



q} Other than the current user and the default Administrator account, what other user is enabled on the target machine?
p1r4t3

Q} What motto has this hidden user set as their account description?
A merry life and a short one.

q} What hidden treasure can be found inside this user’s home directory in C:\Users?
THM{p34rlInAsh3ll}





PowerShell Dynamic System & Security Enumeration:-
For monitoring live system activity, PowerShell provides cmdlets that expose running processes, services, network connections, and file integrity details. These are especially useful for troubleshooting, incident response, and threat hunting.


Get-Process
Displays all running processes along with CPU usage, memory consumption, and process IDs. Commonly used to detect suspicious or resource-heavy processes.

Get-Service
Lists services on the system and their current status (Running, Stopped, Paused). Useful for identifying malicious or tampered services during forensic investigations.

Get-NetTCPConnection
Shows active TCP connections, including local/remote addresses, ports, connection state, and the process responsible for the connection. Critical for detecting backdoors and unauthorized network activity.

Get-FileHash
Generates cryptographic hashes (e.g., SHA256) for files. Used to verify file integrity and detect tampering or malware.

Get-Item -Stream
Reveals Alternate Data Streams (ADS) attached to NTFS files. ADS can be abused to hide malicious data without affecting the main file contents.

Together, these cmdlets provide real-time visibility into system behavior and are essential tools for security analysts and incident responders.



Questions

q} What is the hash of the file containing the hidden treasure found earlier?
71FC5EC11C2497A32F8F08E61399687D90ABE6E204D2964DF589543A613F3E08

Q} Which property returned by Get-NetTCPConnection identifies the process that initiated the connection?
OwningProcess

Q} A critical service was tampered with and its DisplayName modified to match the attacker’s motto. What is the service name?
p1r4t3-s-compass


























